refatorar o modal de criaÃ§Ã£o/ediÃ§Ã£o de Plano de Trabalho, mantendo toda a lÃ³gica de cÃ¡lculo existente, mas ajustando UX, governanÃ§a e fluxo de ediÃ§Ã£o conforme descrito abaixo.

ğŸ¯ OBJETIVO GERAL

Tornar o modal de planejamento consistente com o Cadastro de Atividades

Permitir ediÃ§Ã£o de SLA, materiais e ferramentas

Garantir governanÃ§a obrigatÃ³ria:
ğŸ‘‰ qualquer alteraÃ§Ã£o estrutural deve gerar uma NOVA atividade

Impedir que atividades existentes sejam sobrescritas

Melhorar clareza visual e experiÃªncia do usuÃ¡rio

1ï¸âƒ£ CONCEITO-BASE (REGRA DE NEGÃ“CIO)

O planejamento nunca altera uma atividade existente

Atividades existentes sÃ£o imutÃ¡veis no planejamento

O planejamento pode editar valores, mas isso cria um fork da atividade

ğŸ” AlteraÃ§Ãµes consideradas estruturais:

SLA fixo

SLA por mÂ²

Materiais

Ferramentas

Qualquer alteraÃ§Ã£o nesses itens:
â¡ï¸ obriga salvar como nova atividade

2ï¸âƒ£ ATIVIDADE NO PLANEJAMENTO
Comportamento inicial:

UsuÃ¡rio seleciona uma atividade existente

O sistema:

Carrega SLA fixo

Carrega SLA por mÂ²

Carrega materiais

Carrega ferramentas

Esses dados sÃ£o exibidos como valores ativos, porÃ©m com controle de alteraÃ§Ã£o.

3ï¸âƒ£ SLA â€” EDITÃVEL COM GOVERNANÃ‡A
Campos exibidos:

SLA fixo (min)

SLA por mÂ² (min/mÂ²)

Regras:

Os dois campos:

âœ… SÃ£o editÃ¡veis

âš ï¸ TÃªm detecÃ§Ã£o de alteraÃ§Ã£o

Ao editar qualquer SLA:

Marcar a atividade como â€œmodificadaâ€

Exibir aviso visual

Bloquear salvar direto do plano

Texto explicativo:

AlteraÃ§Ãµes em SLA exigem salvar como nova atividade.

4ï¸âƒ£ MATERIAIS E FERRAMENTAS
PadrÃ£o visual obrigatÃ³rio:

Dropdown com pesquisa

Mesmo componente usado no Cadastro de Atividades

Nada de checkbox ou radio listando tudo

Comportamento:

Itens vÃªm prÃ©-selecionados da atividade

UsuÃ¡rio pode:

Adicionar

Remover

Qualquer mudanÃ§a:

Marca atividade como modificada

Exige salvar como nova atividade

5ï¸âƒ£ DETECÃ‡ÃƒO DE ALTERAÃ‡Ã•ES (REGRA CENTRAL)

Criar um estado interno, por exemplo:

hasActivityChanges = true | false


Esse estado deve virar true se:

SLA fixo mudar

SLA por mÂ² mudar

Lista de materiais mudar

Lista de ferramentas mudar

6ï¸âƒ£ BLOQUEIO DE SALVAMENTO
Se hasActivityChanges === false

Permitir:

Salvar plano normalmente

Usar atividade existente

Se hasActivityChanges === true

âŒ Bloquear botÃ£o Salvar Plano

Exibir aviso:

Esta atividade foi modificada. Para continuar, Ã© necessÃ¡rio salvÃ¡-la como uma nova atividade.

7ï¸âƒ£ MODAL OBRIGATÃ“RIO â€” â€œSALVAR COMO NOVA ATIVIDADEâ€

Abrir automaticamente quando:

UsuÃ¡rio tenta salvar plano com alteraÃ§Ãµes estruturais

ConteÃºdo mÃ­nimo:
Salvar como nova atividade

Nome da nova atividade * [input]

[ Salvar atividade e continuar ]
[ Cancelar ]

Regras:

Nome Ã© obrigatÃ³rio

Nome nÃ£o pode ser igual ao da atividade original

Ao confirmar:

Criar nova atividade no cadastro

Copiar:

SLA fixo

SLA por mÂ²

Materiais

Ferramentas

Associar automaticamente a nova atividade ao plano

Liberar botÃ£o â€œSalvar Planoâ€

8ï¸âƒ£ CÃLCULO DE TEMPO (MANTER FUNCIONAL)

Recalcular automaticamente quando:

SLA fixo muda

SLA por mÂ² muda

Ãrea muda

Exibir:

Ãrea do local: XX mÂ²
Tempo estimado total: HH:mm


(Opcional)

Tempo = SLA fixo + (Ãrea Ã— SLA por mÂ²)

9ï¸âƒ£ LIMPEZA DE UI (OBRIGATÃ“RIO)

Remover do modal:

Inputs duplicados de SLA

Checkboxes/radios para materiais e ferramentas

Qualquer campo tÃ©cnico que nÃ£o seja essencial

Priorizar:

Leitura clara

Fluxo lÃ³gico

SeparaÃ§Ã£o visual entre:

Dados da atividade

Dados do plano

ğŸ”§ COMENTÃRIO OBRIGATÃ“RIO NO CÃ“DIGO

Adicionar no componente do modal:

// No planejamento, atividades existentes nunca sÃ£o sobrescritas.
// Qualquer alteraÃ§Ã£o em SLA, materiais ou ferramentas
// exige salvar como nova atividade.

âœ… RESULTADO ESPERADO

Planejamento flexÃ­vel

GovernanÃ§a forte

Zero risco de bagunÃ§ar cadastro

UX simples e previsÃ­vel

Planejamento funciona como â€œforkâ€ de atividade